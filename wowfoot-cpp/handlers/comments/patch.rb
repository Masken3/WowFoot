require 'date'

# Release dates of WoW patches, according to wowhead.
# Used to mark comments.
V = ["1.12.0", "1.12.1", "1.12.2", "2.0.1", "2.0.3", "2.0.4", "2.0.5", "2.0.6", "2.0.7", "2.0.8", "2.0.10", "2.0.12", "2.1.0", "2.1.1", "2.1.2", "2.1.3", "2.2.0", "2.2.2", "2.2.3", "2.3.0", "2.3.2", "2.3.3", "2.4.0", "2.4.1", "2.4.2", "2.4.3", "3.0.2", "3.0.3", "3.0.8", "3.0.9", "3.1.0", "3.1.1", "3.1.2", "3.1.3", "3.2.0", "3.2.2", "3.3.0", "3.3.2", "3.3.3", "3.3.5", "4.0.1", "4.0.3", "4.0.6", "4.1.0", "4.2.0", "4.2.2", "?????"];
T = [1153540800000, 1159243200000, 1160712000000, 1165294800000, 1168318800000, 1168578000000, 1168750800000, 1169528400000, 1171342800000, 1171602000000, 1173157200000, 1175572800000, 1179806400000, 1181016000000, 1182225600000, 1184040000000, 1190692800000, 1191297600000, 1191902400000, 1194930000000, 1199768400000, 1200978000000, 1206417600000, 1207022400000, 1210651200000, 1216094400000, 1223956800000, 1225774800000, 1232427600000, 1234242000000, 1239681600000, 1240286400000, 1242705600000, 1243915200000, 1249358400000, 1253595600000, 1260266400000, 1265104800000, 1269320400000, 1277182800000, 1286834400000, 1289862000000, 1297119600000, 1303768800000, 1309212000000, 1314655200000, 9999999999999];

#p V.size
#p T.size
raise unless(V.size == T.size)

out = open(ARGV[0], 'w')
out.puts '#include "patch.h"'
out.puts 'const PatchVersion gPatchVersions[] = {'
V.each_with_index do |v, i|
	d = T[i] / 1000
	out.puts "{\"#{v}\", #{d}},\t//#{Time.at(d).utc}"
end
out.puts "};"
out.puts "const int gnPatchVersions = #{V.size};"
